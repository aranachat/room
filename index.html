<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ฺุช ุขุฑุงูุง - ููุจุงู</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/font-face.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Login Page -->
    <div class="login-page" id="loginPage">
        <div class="login-card">
            <div style="font-size: 48px; margin-bottom: 20px; color: #8a2be2;">๐ฌ</div>
            <h1 style="color: #e0e0e0; margin-bottom: 10px;">ฺุช ุขุฑุงูุง - ูุณุฎู ููุจุงู</h1>
            <p style="color: #b0b0b0; margin-bottom: 30px; font-size: 14px;">ฺุช ุงูู ุจุง ุณุณุชู ูุงฺฉ ู ุญุฐู ุฎูุฏฺฉุงุฑ ูพุงูโูุง</p>
            
            <input type="text" 
                   class="login-input" 
                   id="usernameInput" 
                   placeholder="ูุงู ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ"
                   maxlength="20"
                   autocomplete="off">
            
            <!-- ูพูู ุชูุธูุงุช ุญุฐู ุฎูุฏฺฉุงุฑ -->
            <div class="expiration-panel">
                <h4 style="color: #e0e0e0; margin-bottom: 10px; font-size: 14px;">โฐ ุชูุธูุงุช ุญุฐู ุฎูุฏฺฉุงุฑ ูพุงูโูุง:</h4>
                <p style="color: #b0b0b0; font-size: 12px; line-height: 1.6; margin-bottom: 10px;">
                    ูพุงูโูุง ูพุณ ุงุฒ ูุฏุช ุฒูุงู ุงูุชุฎุงุจ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุญุฐู ุฎูุงููุฏ ุดุฏ.
                </p>
                
                <div class="expiration-options" id="expirationOptions">
                    <div class="expiration-option" onclick="selectExpiration(5)">
                        <input type="radio" name="expiration" id="expire5" style="display: none;">
                        <label for="expire5" style="cursor: pointer; display: flex; align-items: center; gap: 10px; width: 100%;">
                            <div style="width: 16px; height: 16px; border-radius: 50%; border: 2px solid #8a2be2; display: flex; align-items: center; justify-content: center;">
                                <div style="width: 8px; height: 8px; border-radius: 50%; background: #8a2be2; display: none;"></div>
                            </div>
                            <span>ุญุฐู ูพุณ ุงุฒ ต ุฏููู</span>
                        </label>
                    </div>
                    
                    <div class="expiration-option" onclick="selectExpiration(10)">
                        <input type="radio" name="expiration" id="expire10" style="display: none;">
                        <label for="expire10" style="cursor: pointer; display: flex; align-items: center; gap: 10px; width: 100%;">
                            <div style="width: 16px; height: 16px; border-radius: 50%; border: 2px solid #8a2be2; display: flex; align-items: center; justify-content: center;">
                                <div style="width: 8px; height: 8px; border-radius: 50%; background: #8a2be2; display: none;"></div>
                            </div>
                            <span>ุญุฐู ูพุณ ุงุฒ ฑฐ ุฏููู</span>
                        </label>
                    </div>
                    
                    <div class="expiration-option" onclick="selectExpiration(30)">
                        <input type="radio" name="expiration" id="expire30" style="display: none;">
                        <label for="expire30" style="cursor: pointer; display: flex; align-items: center; gap: 10px; width: 100%;">
                            <div style="width: 16px; height: 16px; border-radius: 50%; border: 2px solid #8a2be2; display: flex; align-items: center; justify-content: center;">
                                <div style="width: 8px; height: 8px; border-radius: 50%; background: #8a2be2; display: none;"></div>
                            </div>
                            <span>ุญุฐู ูพุณ ุงุฒ ณฐ ุฏููู</span>
                        </label>
                    </div>
                    
                    <div class="expiration-option" onclick="selectExpiration(0)">
                        <input type="radio" name="expiration" id="expireNever" style="display: none;">
                        <label for="expireNever" style="cursor: pointer; display: flex; align-items: center; gap: 10px; width: 100%;">
                            <div style="width: 16px; height: 16px; border-radius: 50%; border: 2px solid #8a2be2; display: flex; align-items: center; justify-content: center;">
                                <div style="width: 8px; height: 8px; border-radius: 50%; background: #8a2be2; display: none;"></div>
                            </div>
                            <span>ูุฑฺฏุฒ ุญุฐู ูุดูุฏ</span>
                        </label>
                    </div>
                </div>
            </div>
            
            <button class="login-btn" id="loginBtn" onclick="login()">
                <span id="loginBtnText">๐ ูุฑูุฏ ุจู ฺุช</span>
            </button>
        </div>
    </div>
    
    <!-- Main Chat -->
    <div class="container" id="chatContainer" style="display: none;">
        <div class="chat-header">
            <button class="mobile-menu-btn" id="mobileMenuBtn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="mobile-header-info">
                <span id="mobileChatTitle">ฺุช ุขุฑุงูุง</span>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <div class="status-online" id="mobileStatusIndicator"></div>
                    <span id="mobileUserCount">0</span>
                </div>
            </div>
            
            <div style="display: flex; align-items: center; gap: 15px;">
                <div style="background: rgba(138, 43, 226, 0.1); padding: 6px 12px; border-radius: 15px; font-size: 12px; display: flex; align-items: center; gap: 6px; border: 1px solid rgba(138, 43, 226, 0.3);">
                    <div class="status-online" id="statusIndicator"></div>
                    <span id="connectionStatus">ุฏุฑ ุญุงู ุงุชุตุงู...</span>
                </div>
            </div>
        </div>
        
        <div class="main-layout">
            <!-- Sidebar for Mobile -->
            <div class="mobile-overlay" id="mobileOverlay" onclick="toggleSidebar()"></div>
            
            <div class="sidebar" id="sidebar">
                <button class="close-sidebar-btn" onclick="toggleSidebar()">
                    <i class="fas fa-times"></i>
                </button>
                
                <div style="padding: 15px; border-bottom: 1px solid #2a2a2a; margin-top: 40px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="color: #e0e0e0; font-size: 16px;">๐ฅ ฺฉุงุฑุจุฑุงู ุขููุงู</h3>
                        <span style="background: #00cc66; color: white; padding: 2px 8px; border-radius: 10px; font-size: 12px; font-weight: bold;" id="onlineCount">0</span>
                    </div>
                    <div class="users-list" id="publicUsersList">
                        <!-- ฺฉุงุฑุจุฑุงู ุนููู ุงูุฌุง ููุงุด ุฏุงุฏู ูโุดููุฏ -->
                    </div>
                    
                    <!-- ุงุทูุงุนุงุช ุฐุฎุฑู ุณุงุฒ -->
                    <div class="storage-info" id="storageInfo">
                        <div>๐พ ุฐุฎุฑู ุณุงุฒ:</div>
                        <div id="messageCount">0 ูพุงู</div>
                        <div id="storageStatus">...</div>
                        <div id="expirationStatus" style="margin-top: 5px; font-size: 11px;"></div>
                    </div>
                </div>
                
                <div style="padding: 15px; margin-top: auto; border-top: 1px solid #2a2a2a;">
                    <div class="mobile-actions">
                        <button onclick="refreshNetwork()" class="mobile-action-btn primary">
                            <i class="fas fa-sync-alt"></i> ุจุฑูุฒุฑุณุงู
                        </button>
                    </div>
                    
                    <div class="mobile-actions">
                        <button onclick="clearLocalStorage()" class="mobile-action-btn danger">
                            <i class="fas fa-trash-alt"></i> ูพุงฺฉุณุงุฒ
                        </button>
                        <button onclick="leaveChat()" class="mobile-action-btn" style="background: linear-gradient(135deg, #444, #222);">
                            <i class="fas fa-sign-out-alt"></i> ุฎุฑูุฌ
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Chat Area -->
            <div class="chat-area">
                <div style="padding: 10px 15px; background: #1e1e1e; border-bottom: 1px solid #2a2a2a; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div style="font-size: 16px; color: #e0e0e0; font-weight: bold;" id="chatTitle">๐ฌ ฺุช ุนููู</div>
                        <div style="font-size: 11px; color: #b0b0b0;" id="chatInfo">ูพุงูโูุง ุนููู</div>
                        <div id="adminStatusDisplay" style="font-size: 12px; margin-top: 5px;"></div>
                    </div>
                    <div id="chatActions">
                        <button onclick="clearChat()" style="padding: 4px 8px; background: #2a2a2a; color: #e0e0e0; border: 1px solid #3a3a3a; border-radius: 6px; font-size: 11px; cursor: pointer; font-weight: bold;">
                            <i class="fas fa-trash"></i> ูพุงฺฉ ฺฉุฑุฏู
                        </button>
                    </div>
                </div>
                
                <!-- ูพูู ุฑูพูุง -->
                <div class="reply-panel" id="replyPanel" style="display: none;">
                    <div style="flex: 1;">
                        <div class="reply-author" id="replyAuthor"></div>
                        <div class="reply-content" id="replyContent"></div>
                    </div>
                    <button class="cancel-reply-btn" onclick="cancelReply()">ูุบู</button>
                </div>
                
                <div class="messages-container" id="messagesContainer">
                    <!-- ูพุงูโูุง ุงูุฌุง ููุงุด ุฏุงุฏู ูโุดููุฏ -->
                    <div style="text-align: center; padding: 40px 20px; color: #b0b0b0;" id="emptyState">
                        <div style="font-size: 48px; margin-bottom: 15px; opacity: 0.5;">๐ฌ</div>
                        <p>ูููุฒ ูพุงู ุงุฑุณุงู ูุดุฏู ุงุณุช</p>
                        <p style="font-size: 12px; margin-top: 10px;">ุงููู ูพุงู ุฑุง ุดูุง ุงุฑุณุงู ฺฉูุฏ!</p>
                    </div>
                </div>
                
                <!-- ูุถุนุช ุดุจฺฉู ุฏุฑ ููุจุงู -->
                <div class="network-status" id="networkStatus">
                    <span id="networkStatusText">ุงุชุตุงู ุจุฑูุฑุงุฑ ุงุณุช</span>
                    <span id="networkAdminInfo" style="font-size: 11px; color: #8a2be2;"></span>
                </div>
                
                <div class="input-area">
                    <div class="input-wrapper">
                        <div class="action-buttons" id="actionButtons">
                            <button onclick="toggleEmojiPicker()" style="padding: 5px 10px; background: #2a2a2a; color: #e0e0e0; border: 1px solid #3a3a3a; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: bold;">
                                ๐
                            </button>
                            <label for="fileInput" style="padding: 5px 10px; background: #00cc66; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: bold;">
                                <i class="fas fa-image"></i>
                                <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
                            </label>
                        </div>
                        <textarea id="messageInput" 
                                  class="message-input" 
                                  placeholder="ูพุงู ุฎูุฏ ุฑุง ุจููุณุฏ..." 
                                  rows="1"
                                  onkeydown="handleKeyPress(event)"
                                  oninput="autoResize(this)"></textarea>
                    </div>
                    <button onclick="sendMessage()" id="sendBtn" class="send-btn">ุงุฑุณุงู</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Emoji Picker for Mobile -->
    <div id="emojiPicker" style="display: none; position: fixed; bottom: 120px; right: 10px; left: 10px; background: #2a2a2a; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.7); padding: 15px; z-index: 1002; border: 1px solid #3a3a3a; max-height: 200px; overflow-y: auto;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 10px; align-items: center;">
            <div style="font-weight: bold; color: #e0e0e0;">ุงููุฌโูุง</div>
            <button onclick="toggleEmojiPicker()" style="background: none; border: none; cursor: pointer; font-size: 18px; color: #e0e0e0;">ร</button>
        </div>
        <div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: center;">
            <!-- Emojis will be inserted here -->
        </div>
    </div>

    <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
